# MediaPipe Pose 게임 개발 과정 요약

## 🎯 프로젝트 목표
- MediaPipe를 활용한 실시간 포즈 감지 게임
- 실시간 좌표 표시 및 Linux Time 기준 데이터 저장
- 벽모양 포즈 따라하기 기능

## 📋 개발 단계별 진행

### 1단계: 기본 구조 설계
**목표**: MediaPipe Pose 감지 기본 기능 구현
**구현 내용**:
- HTML 템플릿 생성
- MediaPipe 라이브러리 로딩
- 기본 카메라 연결
- Canvas 렌더링

**주요 의사결정**:
- FastAPI 백엔드 사용 (기존 코드 활용)
- CDN 기반 MediaPipe 라이브러리 로딩
- 실시간 스트리밍 방식 채택

### 2단계: 실시간 스트리밍 문제 해결
**문제**: MediaPipe가 실시간으로 렌더링되지 않음
**해결 과정**:
1. **라이브러리 로딩 개선**
   - 특정 버전 고정 (`@0.3`, `@0.5`, `@0.6`)
   - 로딩 순서 최적화
   - 대기 로직 구현 (100회 재시도)

2. **Canvas 렌더링 최적화**
   - Canvas 크기 명시적 설정
   - 이미지 존재 여부 확인
   - 에러 처리 강화

3. **Skeleton 그리기 개선**
   - MediaPipe 기본 함수 우선 사용
   - 실패 시 대체 그리기 함수 구현
   - 가시성 기반 필터링

### 3단계: 사용자 경험 개선
**문제**: 카메라 권한 및 기술적 문제로 인한 사용자 혼란
**해결 과정**:
1. **권한 요청 UI 개선**
   - 단계별 안내 버튼 추가
   - 브라우저별 설정 가이드 제공
   - 실시간 상태 표시

2. **에러 처리 강화**
   - 구체적인 에러 메시지 제공
   - 자동 복구 메커니즘 구현
   - 사용자 친화적 안내

### 4단계: 실시간 좌표 표시 및 저장
**목표**: 포즈 데이터 실시간 표시 및 저장
**구현 내용**:
1. **실시간 좌표 표시**
   - 모든 랜드마크 좌표 표시
   - 가시성 기반 필터링
   - 퍼센트 단위 변환

2. **Linux Time 기준 저장**
   - Unix timestamp 사용
   - JSON 형태로 저장
   - 실시간 서버 전송

3. **녹화 시스템**
   - 토글 버튼으로 간편 제어
   - 자동 파일 다운로드
   - 상태 표시

### 5단계: 벽모양 따라하기 기능
**목표**: 게임 요소 추가
**구현 내용**:
1. **벽모양 포즈 데이터**
   - T자, V자, X자 포즈 정의
   - 연결선 및 포인트 그리기
   - 자동 포즈 변경

2. **타이머 시스템**
   - 5초 타이머 구현
   - 성공/실패 판정
   - 다음 라운드 자동 진행

## 🔧 기술적 의사결정

### 1. 라이브러리 선택
**MediaPipe**: 실시간 포즈 감지에 최적화된 라이브러리
**FastAPI**: 기존 백엔드 코드와의 호환성
**Canvas API**: 실시간 렌더링을 위한 표준 웹 기술

### 2. 아키텍처 설계
**Frontend-Backend 분리**: 확장성과 유지보수성 고려
**RESTful API**: 표준 웹 API 설계 원칙 준수
**실시간 데이터 전송**: WebSocket 대신 HTTP 기반 실시간 전송

### 3. 데이터 저장 전략
**JSON 형태**: 분석 용이성과 호환성 고려
**Linux timestamp**: 정확한 시간 기록 보장
**파일 기반 저장**: 서버 리소스 효율적 사용

## 🚀 성능 최적화

### 1. 렌더링 최적화
- Canvas 크기 명시적 설정
- 불필요한 랜드마크 필터링
- 프레임 처리 최적화

### 2. 메모리 관리
- 스트림 정리 로직 구현
- 데이터 로그 크기 제한
- 가비지 컬렉션 고려

### 3. 네트워크 최적화
- 실시간 데이터 전송
- 에러 시 재시도 로직
- 연결 상태 모니터링

## 📊 결과 및 성과

### 1. 기능 완성도
- ✅ 실시간 MediaPipe Pose 감지
- ✅ 실시간 좌표 표시
- ✅ Linux Time 기준 데이터 저장
- ✅ 벽모양 따라하기 게임
- ✅ 녹화 시스템

### 2. 사용자 경험
- ✅ 직관적인 UI/UX
- ✅ 단계별 안내 시스템
- ✅ 에러 처리 및 복구
- ✅ 실시간 피드백

### 3. 기술적 안정성
- ✅ 라이브러리 호환성 확보
- ✅ 크로스 브라우저 지원
- ✅ 에러 처리 강화
- ✅ 성능 최적화

## 🔮 향후 개선 방향

### 1. 기능 확장
- 다양한 포즈 패턴 추가
- 난이도 조절 시스템
- 멀티플레이어 지원

### 2. 성능 개선
- WebAssembly 활용
- GPU 가속 지원
- 실시간 분석 기능

### 3. 사용자 경험
- 모바일 최적화
- 접근성 개선
- 다국어 지원

## 📝 개발 과정에서의 교훈

### 1. 라이브러리 통합
- 버전 호환성 사전 확인 필요
- 대체 방안 준비 중요
- 단계별 테스트 필수

### 2. 실시간 처리
- 성능 최적화 중요
- 에러 처리 필수
- 사용자 피드백 제공

### 3. 사용자 경험
- 기술적 문제를 사용자 친화적으로 해결
- 단계별 안내 제공
- 실시간 상태 표시

이러한 개발 과정을 통해 MediaPipe를 활용한 실시간 포즈 감지 게임을 성공적으로 구현했습니다. 